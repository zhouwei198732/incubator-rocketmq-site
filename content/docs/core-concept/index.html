<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Core Concept - Apache RocketMQ</title>




<meta name="description" content="">




<meta property="og:locale" content="en">
<meta property="og:site_name" content="Apache RocketMQ">
<meta property="og:title" content="Core Concept">




  <meta property="og:description" content="">



  <meta name="twitter:site" content="@ApacheRocketMQ">
  <meta name="twitter:title" content="Core Concept">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-12-29T16:04:39+08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Apache RocketMQ",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Apache RocketMQ Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="/">Apache RocketMQ</a></li>
          
            
            <li class="masthead__menu-item"><a href="/docs/quick-start/">Documentation</a></li>
          
            
            <li class="masthead__menu-item"><a href="/year-archive/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="/community/">Community</a></li>
          
            
            <li class="masthead__menu-item"><a href="/about/">About</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">User Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/quick-start/" class="">Quick Start</a></li>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Motivation</a></li>
          
            
            

            
            

            <li><a href="/docs/core-concept/" class="active">Core Concept</a></li>
          
            
            

            
            

            <li><a href="/docs/cli-admin-tool/" class="">CLI Admin Tool</a></li>
          
            
            

            
            

            <li><a href="/docs/cluster-deployment/" class="">Cluster Configuration & Deployment</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Contributor Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/pull-request/" class="">Best Practice in PR</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Developer Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Architecture & Design</a></li>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Communication Protocol</a></li>
          
            
            

            
            

            <li><a href="/docs/core-concept/" class="active">Persistence</a></li>
          
            
            

            
            

            <li><a href="/docs/cli-admin-tool/" class="">Replication</a></li>
          
            
            

            
            

            <li><a href="/docs/cluster-deployment/" class="">Service Discovery & Load Balance</a></li>
          
            
            

            
            

            <li><a href="/docs/cluster-deployment/" class="">Message Filter</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Best Practice</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Broker</a></li>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Producer</a></li>
          
            
            

            
            

            <li><a href="/docs/core-concept/" class="active">Consumer</a></li>
          
            
            

            
            

            <li><a href="/docs/cli-admin-tool/" class="">Virtualization</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/docs/faq/"><span class="nav__sub-title">FAQ</span></a>
        

        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Core Concept">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="December 29, 2016">
    <meta itemprop="dateModified" content="December 17, 2016">

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Core Concept
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p><img src="/assets/images/rmq-model.png" alt="RocketMQ model" /></p>

<p>From the above model, we can look deeper into some topics about messaging system design:</p>

<aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#producer" id="markdown-toc-producer">Producer</a>    <ul>
      <li><a href="#producer-group" id="markdown-toc-producer-group">Producer Group</a></li>
    </ul>
  </li>
  <li><a href="#consumer" id="markdown-toc-consumer">Consumer</a>    <ul>
      <li><a href="#pullconsumer" id="markdown-toc-pullconsumer">PullConsumer</a></li>
      <li><a href="#pushconsumer" id="markdown-toc-pushconsumer">PushConsumer</a></li>
      <li><a href="#consumer-group" id="markdown-toc-consumer-group">Consumer Group</a></li>
    </ul>
  </li>
  <li><a href="#topic" id="markdown-toc-topic">Topic</a></li>
  <li><a href="#message" id="markdown-toc-message">Message</a>    <ul>
      <li><a href="#message-queue" id="markdown-toc-message-queue">Message Queue</a></li>
      <li><a href="#tag" id="markdown-toc-tag">Tag</a></li>
      <li><a href="#broker" id="markdown-toc-broker">Broker</a></li>
    </ul>
  </li>
  <li><a href="#name-server" id="markdown-toc-name-server">Name Server</a></li>
  <li><a href="#message-model" id="markdown-toc-message-model">Message Model</a></li>
  <li><a href="#message-order" id="markdown-toc-message-order">Message Order</a></li>
</ul>

  </nav>
</aside>

<ul>
  <li>Consumer Concurrency</li>
  <li>Consumer Hot Issues</li>
  <li>Consumer Load Balance</li>
  <li>Message Router</li>
  <li>Connection Multiplex</li>
  <li>Canary Deployments</li>
</ul>

<h1 id="producer">Producer</h1>

<p>A producer sends messages generated by the business application systems to brokers. RocketMQ provides multiple paradigms of sending: synchronous, asynchronous and one-way.</p>

<h2 id="producer-group">Producer Group</h2>

<p>Producers of the same role are grouped together. A different producer instance of the same producer group may be contacted by a broker to commit or roll back a transaction in case the original producer crashed after starting the transaction.</p>

<p><strong>Warning</strong>: Considering the provided producer is sufficiently powerful at sending messages, only one instance is allowed per producer group and process to avoid unnecessarily initializing of producer instances.</p>

<h1 id="consumer">Consumer</h1>

<p>A Consumer pulls messages from brokers and feeds them into application. In perspective of user application, two types of consumers are provided:</p>

<h2 id="pullconsumer">PullConsumer</h2>

<p>Pull consumer actively pulls messages from brokers. Once batches of messages are pulled, user application initiates consuming process.</p>

<h2 id="pushconsumer">PushConsumer</h2>

<p>Push consumer, on the other hand, encapsulates message pulling, consuming progress maintaining and other effortful work inside, leaving a callback interface to end user to implement which will be executed on message arrival.</p>

<h2 id="consumer-group">Consumer Group</h2>

<p>Similar to previously mentioned producer group, consumers of the exactly same role are grouped together and named <strong>Consumer Group</strong>.</p>

<p>Consumer Group is a great concept with which achieving goals of load-balance and fault-tolerance, in terms of message consuming, is super easy.</p>

<p><strong>Warning</strong>: consumer instances of a consumer group <strong>must</strong> have exactly same topic subscription(s).</p>

<h1 id="topic">Topic</h1>

<p>Topic is a category to which producers deliver messages and from which consumers pull messages. Topics have very loose relation with producers and consumers. Specifically, a topic may have zero, one or multiple producers that sends messages to it; conversely, a producer can sends messages of different topics. In consumer’s view, a topic may be subscribed by zero, one or multiple consumer groups; and a consumer group, in the same paradigm, may subscribe one or multiple topics as long as instances of this group keep their subscription consistent as emphasized in the previous section.</p>

<h1 id="message">Message</h1>

<p>Message is the envelope of your information to deliver. A message must be specified with a topic, which can be interpreted as address of your letter to mail to. A message may also have an optional tag set. Extra key-value pairs may also be included. For example, you may set a business key for your message and look up the message on broker server to diagnose issues during development.</p>

<h2 id="message-queue">Message Queue</h2>

<p>Topic, internally, is logically partitioned into one or more sub-topics. We call these sub-topics “message queues”. This concept plays a major role in implementing valuable features, including fail-over, maximum concurrency, etc.</p>

<h2 id="tag">Tag</h2>

<p>Tag, which can be thought as sub-topic, provides an extra flexibility for user. Through introducing tag,  messages with different purposes from the same business module may have the same topic yet different tag. It would be helpful to keep your code clean and coherent.</p>

<h2 id="broker">Broker</h2>

<p>Broker is the major role of the RocketMQ system. It receives messages sent from producers, store them and being prepared to serve pull requests from consumers. It also stores message consuming related meta data, including consumer groups, consuming progress offsets and topic / queue info.</p>

<h1 id="name-server">Name Server</h1>

<p>Name server serves as the routing information provider. Producer/Consumer clients look up topics to find broker list to read from and write to.</p>

<h1 id="message-model">Message Model</h1>

<ul>
  <li>
    <p>Clustering</p>
  </li>
  <li>
    <p>Broadcasting</p>
  </li>
</ul>

<h1 id="message-order">Message Order</h1>

<p>When DefaultMQPushConsumer is employed, you may decide to consume messages orderly or concurrently.</p>

<ul>
  <li>Orderly</li>
</ul>

<p>Consuming messages orderly means messages are consumed the same order they are sent by producers for each message queue. If you are dealing with scenario that global order is mandatory, make sure the topic you use has only one message queue.</p>

<p><strong>Warn</strong>: If consuming orderly is specified, the maximum concurrency of message consuming is the number of message queues subscribed by the consumer group.</p>

<ul>
  <li>Concurrently</li>
</ul>

<p>When consuming concurrently, maximum concurrency of message consuming is only limited by thread pool specified for each consumer client.</p>

<p><strong>Warn</strong>: Message order is no longer guaranteed in this mode.</p>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-12-17">December 17, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=ApacheRocketMQ&text=Core Concept /docs/core-concept/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=/docs/core-concept/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=/docs/core-concept/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=/docs/core-concept/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/docs/motivation/" class="pagination--pager" title="Motivation
">Previous</a>
    
    
      <a href="/docs/cli-admin-tool/" class="pagination--pager" title="CLI Admin Tool
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/ApacheRocketMQ"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/apache/incubator-rocketmq"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">Copyright &copy; 2016 <a href="http://www.apache.org/">The Apache Software Foundation</a>. All Rights Reserved.</div>
      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>





  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'rocketmq';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>
